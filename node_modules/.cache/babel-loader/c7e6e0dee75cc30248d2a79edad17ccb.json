{"ast":null,"code":"var inherits = require('util').inherits;\n\nvar Connection = require('./Connection');\n\nvar Events = require('events');\n\nmodule.exports = PoolConnection;\ninherits(PoolConnection, Connection);\n\nfunction PoolConnection(pool, options) {\n  Connection.call(this, options);\n  this._pool = pool; // Bind connection to pool domain\n\n  if (Events.usingDomains) {\n    this.domain = pool.domain;\n  } // When a fatal error occurs the connection's protocol ends, which will cause\n  // the connection to end as well, thus we only need to watch for the end event\n  // and we will be notified of disconnects.\n\n\n  this.on('end', this._removeFromPool);\n  this.on('error', function (err) {\n    if (err.fatal) {\n      this._removeFromPool();\n    }\n  });\n}\n\nPoolConnection.prototype.release = function release() {\n  var pool = this._pool;\n\n  if (!pool || pool._closed) {\n    return undefined;\n  }\n\n  return pool.releaseConnection(this);\n}; // TODO: Remove this when we are removing PoolConnection#end\n\n\nPoolConnection.prototype._realEnd = Connection.prototype.end;\n\nPoolConnection.prototype.end = function () {\n  console.warn('Calling conn.end() to release a pooled connection is ' + 'deprecated. In next version calling conn.end() will be ' + 'restored to default conn.end() behavior. Use ' + 'conn.release() instead.');\n  this.release();\n};\n\nPoolConnection.prototype.destroy = function () {\n  Connection.prototype.destroy.apply(this, arguments);\n\n  this._removeFromPool(this);\n};\n\nPoolConnection.prototype._removeFromPool = function _removeFromPool() {\n  if (!this._pool || this._pool._closed) {\n    return;\n  }\n\n  var pool = this._pool;\n  this._pool = null;\n\n  pool._purgeConnection(this);\n};","map":{"version":3,"sources":["C:/inetpub/wwwroot/ThesisProject/node_modules/mysql/lib/PoolConnection.js"],"names":["inherits","require","Connection","Events","module","exports","PoolConnection","pool","options","call","_pool","usingDomains","domain","on","_removeFromPool","err","fatal","prototype","release","_closed","undefined","releaseConnection","_realEnd","end","console","warn","destroy","apply","arguments","_purgeConnection"],"mappings":"AAAA,IAAIA,QAAQ,GAAKC,OAAO,CAAC,MAAD,CAAP,CAAgBD,QAAjC;;AACA,IAAIE,UAAU,GAAGD,OAAO,CAAC,cAAD,CAAxB;;AACA,IAAIE,MAAM,GAAOF,OAAO,CAAC,QAAD,CAAxB;;AAEAG,MAAM,CAACC,OAAP,GAAiBC,cAAjB;AACAN,QAAQ,CAACM,cAAD,EAAiBJ,UAAjB,CAAR;;AAEA,SAASI,cAAT,CAAwBC,IAAxB,EAA8BC,OAA9B,EAAuC;AACrCN,EAAAA,UAAU,CAACO,IAAX,CAAgB,IAAhB,EAAsBD,OAAtB;AACA,OAAKE,KAAL,GAAcH,IAAd,CAFqC,CAIrC;;AACA,MAAIJ,MAAM,CAACQ,YAAX,EAAyB;AACvB,SAAKC,MAAL,GAAcL,IAAI,CAACK,MAAnB;AACD,GAPoC,CASrC;AACA;AACA;;;AACA,OAAKC,EAAL,CAAQ,KAAR,EAAe,KAAKC,eAApB;AACA,OAAKD,EAAL,CAAQ,OAAR,EAAiB,UAAUE,GAAV,EAAe;AAC9B,QAAIA,GAAG,CAACC,KAAR,EAAe;AACb,WAAKF,eAAL;AACD;AACF,GAJD;AAKD;;AAEDR,cAAc,CAACW,SAAf,CAAyBC,OAAzB,GAAmC,SAASA,OAAT,GAAmB;AACpD,MAAIX,IAAI,GAAG,KAAKG,KAAhB;;AAEA,MAAI,CAACH,IAAD,IAASA,IAAI,CAACY,OAAlB,EAA2B;AACzB,WAAOC,SAAP;AACD;;AAED,SAAOb,IAAI,CAACc,iBAAL,CAAuB,IAAvB,CAAP;AACD,CARD,C,CAUA;;;AACAf,cAAc,CAACW,SAAf,CAAyBK,QAAzB,GAAoCpB,UAAU,CAACe,SAAX,CAAqBM,GAAzD;;AAEAjB,cAAc,CAACW,SAAf,CAAyBM,GAAzB,GAA+B,YAAY;AACzCC,EAAAA,OAAO,CAACC,IAAR,CACE,0DACA,yDADA,GAEA,+CAFA,GAGA,yBAJF;AAMA,OAAKP,OAAL;AACD,CARD;;AAUAZ,cAAc,CAACW,SAAf,CAAyBS,OAAzB,GAAmC,YAAY;AAC7CxB,EAAAA,UAAU,CAACe,SAAX,CAAqBS,OAArB,CAA6BC,KAA7B,CAAmC,IAAnC,EAAyCC,SAAzC;;AACA,OAAKd,eAAL,CAAqB,IAArB;AACD,CAHD;;AAKAR,cAAc,CAACW,SAAf,CAAyBH,eAAzB,GAA2C,SAASA,eAAT,GAA2B;AACpE,MAAI,CAAC,KAAKJ,KAAN,IAAe,KAAKA,KAAL,CAAWS,OAA9B,EAAuC;AACrC;AACD;;AAED,MAAIZ,IAAI,GAAG,KAAKG,KAAhB;AACA,OAAKA,KAAL,GAAa,IAAb;;AAEAH,EAAAA,IAAI,CAACsB,gBAAL,CAAsB,IAAtB;AACD,CATD","sourcesContent":["var inherits   = require('util').inherits;\r\nvar Connection = require('./Connection');\r\nvar Events     = require('events');\r\n\r\nmodule.exports = PoolConnection;\r\ninherits(PoolConnection, Connection);\r\n\r\nfunction PoolConnection(pool, options) {\r\n  Connection.call(this, options);\r\n  this._pool  = pool;\r\n\r\n  // Bind connection to pool domain\r\n  if (Events.usingDomains) {\r\n    this.domain = pool.domain;\r\n  }\r\n\r\n  // When a fatal error occurs the connection's protocol ends, which will cause\r\n  // the connection to end as well, thus we only need to watch for the end event\r\n  // and we will be notified of disconnects.\r\n  this.on('end', this._removeFromPool);\r\n  this.on('error', function (err) {\r\n    if (err.fatal) {\r\n      this._removeFromPool();\r\n    }\r\n  });\r\n}\r\n\r\nPoolConnection.prototype.release = function release() {\r\n  var pool = this._pool;\r\n\r\n  if (!pool || pool._closed) {\r\n    return undefined;\r\n  }\r\n\r\n  return pool.releaseConnection(this);\r\n};\r\n\r\n// TODO: Remove this when we are removing PoolConnection#end\r\nPoolConnection.prototype._realEnd = Connection.prototype.end;\r\n\r\nPoolConnection.prototype.end = function () {\r\n  console.warn(\r\n    'Calling conn.end() to release a pooled connection is ' +\r\n    'deprecated. In next version calling conn.end() will be ' +\r\n    'restored to default conn.end() behavior. Use ' +\r\n    'conn.release() instead.'\r\n  );\r\n  this.release();\r\n};\r\n\r\nPoolConnection.prototype.destroy = function () {\r\n  Connection.prototype.destroy.apply(this, arguments);\r\n  this._removeFromPool(this);\r\n};\r\n\r\nPoolConnection.prototype._removeFromPool = function _removeFromPool() {\r\n  if (!this._pool || this._pool._closed) {\r\n    return;\r\n  }\r\n\r\n  var pool = this._pool;\r\n  this._pool = null;\r\n\r\n  pool._purgeConnection(this);\r\n};\r\n"]},"metadata":{},"sourceType":"script"}